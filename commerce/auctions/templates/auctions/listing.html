{% extends "auctions/layout.html" %}

{% block style %}
<style>
    body{
        background-color: #242424;
        color: white;
    }
    textarea{
        color: white;
        background-color: #4a4a4a;
        width: 300px;
        height: 50px;
        outline: none;
    }
    .comment{
        margin-left: auto;
        margin-right: auto;
        font-size: 1.3em;
        padding: 20px;
        border: 1px solid black;
        width: 25%;
        list-style-type: none;
        margin-bottom: 15px;
    }
    .price{
        font-size: 1.3em;
        color: #4d90fe;
    }
    .listing{
        text-align: center;
        border: 1px solid #c0c0c0;
        border-style: inset;
        width: 100%;
        margin: 10px;
        padding: 10px;
    }
    .field{
        color: white;
        background-color: #4a4a4a;
        line-height: 24px;
        border: 1px solid #c0c0c0;
        border-radius: 5px;
        width: 25%;
    }
    .field:focus{
        outline: none;
    }
    .add{
        padding: 5px;
        line-height: 16px;
        color: white;
        background-color: #4d90fe;
        border: 1px solid #4d90fe;
        border-radius: 5px;
        margin-bottom: 5px;
    }
    .add:hover{
        background-color: #4787ed;
        border-style: outset;
    }
</style>
{% endblock %}

{% block body %}
    <div class="listing">
        <h1>{{listing.title}}</h1>
        {% if user.is_authenticated %}
            {% if listing in watchlist %}
            <form method='POST' action="{% url 'remove_watchlist' listing.id %}">
                {% csrf_token %}
                <input class='add' type=submit value="remove from watchlist">
            </form>
            {%else%}
            <form method='POST' action="{% url 'add_watchlist' listing.id %}">
                {% csrf_token %}
                <input class='add' type=submit value="add to watchlist">
            </form>
            {% endif %}
        {% endif %}
        {% if listing.image %}
            <img alt="No image" src={{listing.image}} width='200' height="160"><br>
        {% endif %}
        <div class="info">
            {{listing.description}}<br>
            <div class="price">
                {% if listing.starting_bid > listing.current_bid %}
                    ${{listing.starting_bid}}<br>
                {% else %}
                    ${{listing.current_bid}}<br>
                {% endif %}
            </div>
            {% if bid_user == current_user %}
            Highest Bid: ${{max_bid}} | made by you<br>
            {% else %}
            Highest Bid: ${{max_bid}} | made by {{bid_user}}<br>
            {% endif %}
        </div>
        {% if user.is_authenticated %}
        <form method='post' action="{% url 'add_bid' listing.id %}">
            {% csrf_token %}
            <input class='field' type="number" step="0.01" min="{{listing.current_bid}}" name="bid">
            <input class='add' type="submit" value="add bid">
        </form>
        {% endif %}
        Number of bids: {{listing.number_of_bids}}

        <h2>Details</h2>
        <ul>
            {% if listing.user == current_user %}
            <li>listed by: <p style="display: inline-block; color:#4d90fe; margin-bottom: 0;">you</p></li>
            {% else %}
            <li>listed by: <p style="display: inline-block; color:#4d90fe; margin-bottom: 0;">{{listing.user}}</p></li>
            {% endif %}
            <li>category: {{listing.category}}</li>
        </ul>
        {% if user.is_authenticated %}
        <form method='post' action="{% url 'add_comment' listing.id %}" id="commentForm">
            {% csrf_token %}
            <textarea name="comment" form="commentForm"></textarea>
            <input class="add" type='submit' value='add comment'>
        </form>
        {% endif %}
        <h2>Comments</h2>
        <br>
        <ul>
            {% for comment in comments %}
                <li class="comment">{{comment}}</li>
            {% endfor %}
        </ul>
    </div>   
{% endblock %}